<!DOCTYPE html>
<!--[if IEMobile 7 ]>    <html class="no-js iem7"> <![endif]-->
<!--[if (gt IEMobile 7)|!(IEMobile)]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>YHNN</title>
        <meta name="description" content="">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0, minimal-ui">
        <meta http-equiv="cleartype" content="on">
        <link rel="apple-touch-icon" href="../Icon-72@2x.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../Icon-72@2x.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../Icon@2x.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../Icon-72.png">
        <link rel="apple-touch-icon-precomposed" href="../Icon.png">
        <link rel="shortcut icon" href="../Icon-72@2x.png">

        <meta name="msapplication-TileImage" content="img/touch/apple-touch-icon-144x144-precomposed.png">
        <meta name="msapplication-TileColor" content="#222222">

        <link rel="stylesheet" href="../style.css">
        <link rel="stylesheet" href="../slider-styles.css">
        <script src="../js/vendor/jquery.js"></script>
        <script src="../js/vendor/modernizr-2.6.2.min.js"></script>
        <script src="../js/plugins.js"></script>
        <script src="../js/main.js"></script>
        <script src="../phonegap.js"></script>
    </head>
    <body class="feedback">
    
    	<header>
    		<a href="../index.html" class="homeLink"><img src="../images/header_home_icon.jpg" width="20"/></a>
    		<a href="hospital-list.html" class="textLink">Back to hospital list</a>
    		<span class="bottomShadow"></span>
    	</header>
    	
    	<div class="questions">
    		<div class="title">
    			<h1>Leave your Feedback</h1>
    			<h3></h3>
    			<span class="arrow"></span>
    		</div><!-- title -->
    		<p>Rate each question from 1 to 5, 1 being the lowest and 5 being the highest score, or fill in the text box with your answer.</p>
    		<form action="" method="" id="feedbackForm">
    			<input type="hidden" name="hospital" id="hospital" value=""/>
    			<div class="question one">
    				<p><strong>Question one:</strong> Did you find the unit staff approachable?</p>
    				<div id="question_1_slider"></div>
    				<span class="number one">1</span>
    				<span class="number five">5</span>
    			</div><!-- question -->
    			<div class="question two">
    				<p><strong>Question two:</strong> Did you feel your concerns were taken into account?</p>
    				<div id="question_2_slider"></div>
    				<span class="number one">1</span>
    				<span class="number five">5</span>
    			</div><!-- question -->
    			<div class="question three">
    				<p><strong>Question three:</strong> Did you feel unit staff communicated effectively with you about your baby's progress?</p>
    				<div id="question_3_slider"></div>
    				<span class="number one">1</span>
    				<span class="number five">5</span>
    			</div><!-- question -->
    			<a href="" id="nextQuestions">Next page<span></span></a>
    			<div class="question four">
    				<p><strong>Question four:</strong> Were tests and procedures explained to you fully before being undertaken?</p>
    				<div id="question_4_slider"></div>
    				<span class="number one">1</span>
    				<span class="number five">5</span>
    			</div><!-- question -->
    			<div class="question five">
    				<p><strong>Question five:</strong> Did you feel you got all the support you needed during the changeover from ICU to HDU to SCBU (as appropriate)?</p>
    				<div id="question_5_slider"></div>
    				<span class="number one">1</span>
    				<span class="number five">5</span>
    			</div><!-- question -->
    			<div class="question six">
    				<p><strong>Question six:</strong> Did you feel fully involved in your baby's care?</p>
    				<div id="question_6_slider"></div>
    				<span class="number one">1</span>
    				<span class="number five">5</span>
    			</div><!-- question -->
    			<div class="question seven">
    				<p><strong>Question seven:</strong> If you would like to comment on any aspect of your journey through the unit please do so here...</p>
    				<textarea name="question_7" id="question_7"></textarea>
    			</div><!-- question -->
    			<a href="" id="backQuestions">Back<span></span></a>
    			<input type="hidden" name="question_1" id="question_1" value="3"/>
    			<input type="hidden" name="question_2" id="question_2" value="3"/>
    			<input type="hidden" name="question_3" id="question_3" value="3"/>
    			<input type="hidden" name="question_4" id="question_4" value="3"/>
    			<input type="hidden" name="question_5" id="question_5" value="3"/>
    			<input type="hidden" name="question_6" id="question_6" value="3"/>
    			<input type="submit" value="submit"/>
    		</form>
    	</div><!-- questions -->    	
	    
	    <footer>
	    	<span class="topShadow"></span>
    		<a href="../index.html" class="homeLink"><img src="../images/footer_home_icon.png" width="20"/></a>
	    </footer>
    	
        <script src="../js/vendor/zepto.min.js"></script>
        <script src="../js/helper.js"></script>
        
        <script type="text/javascript">
        	$(function(){
	        	// Get Hospital Information
				var chosenHospital = localStorage.getItem('chosenHospital');
				var chosenHospitalClass = chosenHospital.toLowerCase();
				chosenHospitalClass = chosenHospitalClass.replace(/'/g,"");
				chosenHospitalClass = chosenHospitalClass.replace(/ /g,"-");
	        	$('body.feedback').addClass(chosenHospitalClass);
	        	if( localStorage.getItem('chosenColour') != 'undefined' ) {
	        		$('body.feedback').addClass(localStorage.getItem('chosenColour'));
	        	}
				$('#feedbackForm #hospital').val(chosenHospital);
				$('.questions .title h3').text(chosenHospital);
				
	        	// Sliders
				var Link = $.noUiSlider.Link;
				$("#question_1_slider").noUiSlider({
					start: [ 3 ],
					step: 1,
					range: {
						'min': [ 1 ],
						'max': [ 5 ]
					},
					serialization: {
						lower: [
							new Link({
								target: $('#question_1')
							})
						],
						format: {
							decimals: 0,
							mark: ','
						}
					}
				});
				$("#question_2_slider").noUiSlider({
					start: [ 3 ],
					step: 1,
					range: {
						'min': [ 1 ],
						'max': [ 5 ]
					},
					serialization: {
						lower: [
							new Link({
								target: $('#question_2')
							})
						],
						format: {
							decimals: 0,
							mark: ','
						}
					}
				});
				$("#question_3_slider").noUiSlider({
					start: [ 3 ],
					step: 1,
					range: {
						'min': [ 1 ],
						'max': [ 5 ]
					},
					serialization: {
						lower: [
							new Link({
								target: $('#question_3')
							})
						],
						format: {
							decimals: 0,
							mark: ','
						}
					}
				});
				$("#question_4_slider").noUiSlider({
					start: [ 3 ],
					step: 1,
					range: {
						'min': [ 1 ],
						'max': [ 5 ]
					},
					serialization: {
						lower: [
							new Link({
								target: $('#question_4')
							})
						],
						format: {
							decimals: 0,
							mark: ','
						}
					}
				});
				$("#question_5_slider").noUiSlider({
					start: [ 3 ],
					step: 1,
					range: {
						'min': [ 1 ],
						'max': [ 5 ]
					},
					serialization: {
						lower: [
							new Link({
								target: $('#question_5')
							})
						],
						format: {
							decimals: 0,
							mark: ','
						}
					}
				});
				$("#question_6_slider").noUiSlider({
					start: [ 3 ],
					step: 1,
					range: {
						'min': [ 1 ],
						'max': [ 5 ]
					},
					serialization: {
						lower: [
							new Link({
								target: $('#question_6')
							})
						],
						format: {
							decimals: 0,
							mark: ','
						}
					}
				});
				
				// Feedback Form Submit
				$('#feedbackForm').submit(function(e){
					e.preventDefault();
					var hospital = $('#hospital').val();
					var question_1 = $('#question_1').val();
					var question_2 = $('#question_2').val();
					var question_3 = $('#question_3').val();
					var question_4 = $('#question_4').val();
					var question_5 = $('#question_5').val();
					var question_6 = $('#question_6').val();
					var question_7 = $('#question_7').val();
					$.ajax({
					  type: "POST",
					  url: 'http://yhnn.clicky.co.uk/processing/feedback.php',
					  	dataType: 'json',
					  	crossDomain: true,					  
					  data: { hospital : hospital, question_1 : question_1, question_2 : question_2, question_3 : question_3, question_4 : question_4, question_5 : question_5, question_6 : question_6, question_7 : question_7 },
					  success: function(returnData){
					  	if ( returnData == 'Error' ) {
						  	alert('Giving feedback requires an internet connection.(Server)');
						} else {
							$('#feedbackForm').fadeOut('fast');
							$('.feedback .questions > p').text('Thanks for giving us feedback. You will now be taken back to the home screen.');
							setTimeout(function() {
								window.location.replace('../index.html');
						    }, 3000);
					  	}
				      },
				      error:function(returnData){
					  	alert('Giving feedback requires an internet connection.');
					  }
					});
				});
				
				// Next Button
				$('#nextQuestions').click(function(e){
					e.preventDefault();
					$('#nextQuestions').fadeIn('fast');
					$('#backQuestions').show();
					$('#backQuestions span').show(); 
					$('.feedback #feedbackForm .question').hide();
					$('.feedback #feedbackForm .question.four, .feedback #feedbackForm .question.five, .feedback #feedbackForm .question.six, .feedback #feedbackForm .question.seven').fadeIn('fast');
					$(this).hide();
					$('.feedback #feedbackForm input[type=submit]').fadeIn('fast');
				});

				// Back Button
				$('#backQuestions').click(function(e){
					e.preventDefault();
					$('.feedback #feedbackForm input[type=submit]').hide();
					$('#nextQuestions').fadeIn('fast');
					$(this).hide();
					$('.feedback #feedbackForm .question').hide();
					$('.feedback #feedbackForm .question.one, .feedback #feedbackForm .question.two, .feedback #feedbackForm .question.three').fadeIn('fast');
				});		
			});		
        </script>

    </body>
</html>
